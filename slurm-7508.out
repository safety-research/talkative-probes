[ensure_env] Using cached venv: /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Installing Python 3.12 via uv...
[ensure_env] Environment already exists at /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Running on SLURM node: node-1
[ensure_env] Environment ready. Use 'uv run' (not uv_run) for all Python commands.
[ensure_env] Note: The uv_run function is available as a shortcut in this shell.
[ensure_env] .venv exists and is not a symlink; to align it with uv env, remove it or run 'make -C talkative_autoencoder link-venv'
Downloading torch (783.0MiB)
Downloading torch (783.0MiB)
 Downloading torch
Uninstalled 32 packages in 950ms
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
 Downloading torch
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/plotly-6.3.0.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/torch-2.9.0.dev20250804+cu128.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers-4.55.2.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/huggingface_hub-0.34.4.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/numpy-2.2.6.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/httpx-0.28.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/debugpy-1.8.16.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/tornado-6.5.2.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/accelerate-1.10.0.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/sentencepiece-0.2.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/torchvision-0.24.0.dev20250804+cu128.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/narwhals-2.1.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cublas_cu12-12.8.4.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cuda_cupti_cu12-12.8.90.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cuda_nvrtc_cu12-12.8.93.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cuda_runtime_cu12-12.8.90.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cudnn_cu12-9.10.2.21.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cufft_cu12-11.3.3.83.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cufile_cu12-1.13.1.3.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_curand_cu12-10.3.9.90.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cusolver_cu12-11.7.3.90.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cusparse_cu12-12.5.8.93.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_cusparselt_cu12-0.7.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_nccl_cu12-2.27.5.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_nvjitlink_cu12-12.8.93.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/nvidia_nvtx_cu12-12.8.90.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/setuptools-79.0.1.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/triton-3.4.0+git663e04e8.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/safetensors-0.6.2.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/charset_normalizer-3.4.3.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/MarkupSafe-2.1.3.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/multidict-6.6.4.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
Uninstalled 32 packages in 382ms
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 49 packages in 1m 08s
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 567, in <module>
    main()
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 563, in main
    asyncio.run(main_async(args))
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 467, in main_async
    dset = load_input_dataset(args)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 275, in load_input_dataset
    dset_dict: DatasetDict = load_dataset(args.input_dataset)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1392, in load_dataset
    builder_instance = load_dataset_builder(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1132, in load_dataset_builder
    dataset_module = dataset_module_factory(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1025, in dataset_module_factory
    raise e1 from None
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 980, in dataset_module_factory
    raise DatasetNotFoundError(f"Dataset '{path}' doesn't exist on the Hub or cannot be accessed.") from e
datasets.exceptions.DatasetNotFoundError: Dataset 'some_org/some_chat_dataset' doesn't exist on the Hub or cannot be accessed.
Installed 49 packages in 1m 16s
INFO 08-14 15:19:01 [__init__.py:241] Automatically detected platform cuda.
Traceback (most recent call last):
  File "/home/kitf/.cache/uv/envs/consistency-lens/bin/vllm", line 4, in <module>
    from vllm.entrypoints.cli.main import main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/__init__.py", line 3, in <module>
    from vllm.entrypoints.cli.benchmark.latency import BenchmarkLatencySubcommand
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/benchmark/latency.py", line 5, in <module>
    from vllm.benchmarks.latency import add_cli_args, main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/benchmarks/latency.py", line 16, in <module>
    from vllm import LLM, SamplingParams
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/__init__.py", line 64, in __getattr__
    module = import_module(module_name, __package__)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/llm.py", line 20, in <module>
    from vllm.config import (CompilationConfig, ModelDType, TokenizerMode,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/config.py", line 36, in <module>
    from vllm.model_executor.layers.quantization import QuantizationMethods
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/__init__.py", line 4, in <module>
    from vllm.model_executor.parameter import (BasevLLMParameter,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/parameter.py", line 10, in <module>
    from vllm.distributed import get_tensor_model_parallel_rank
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/__init__.py", line 4, in <module>
    from .communication_op import *
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/communication_op.py", line 9, in <module>
    from .parallel_state import get_tp_group
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/parallel_state.py", line 150, in <module>
    from vllm.platforms import current_platform
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/__init__.py", line 273, in __getattr__
    _current_platform = resolve_obj_by_qualname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/utils/__init__.py", line 2509, in resolve_obj_by_qualname
    module = importlib.import_module(module_name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/cuda.py", line 18, in <module>
    import vllm._C  # noqa
    ^^^^^^^^^^^^^^
ImportError: /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/_C.abi3.so: undefined symbol: _ZN3c104cuda9SetDeviceEab
