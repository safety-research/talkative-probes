[ensure_env] Using cached venv: /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Installing Python 3.12 via uv...
[ensure_env] Environment already exists at /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Running on SLURM node: node-1
[ensure_env] Environment ready. Use 'uv run' (not uv_run) for all Python commands.
[ensure_env] Note: The uv_run function is available as a shortcut in this shell.
[ensure_env] Linked .venv -> /home/kitf/.cache/uv/envs/consistency-lens
INFO 08-14 16:04:29 [__init__.py:241] Automatically detected platform cuda.
Traceback (most recent call last):
  File "/home/kitf/.cache/uv/envs/consistency-lens/bin/vllm", line 4, in <module>
    from vllm.entrypoints.cli.main import main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/__init__.py", line 3, in <module>
    from vllm.entrypoints.cli.benchmark.latency import BenchmarkLatencySubcommand
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/benchmark/latency.py", line 5, in <module>
    from vllm.benchmarks.latency import add_cli_args, main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/benchmarks/latency.py", line 16, in <module>
    from vllm import LLM, SamplingParams
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/__init__.py", line 64, in __getattr__
    module = import_module(module_name, __package__)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/llm.py", line 20, in <module>
    from vllm.config import (CompilationConfig, ModelDType, TokenizerMode,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/config.py", line 36, in <module>
    from vllm.model_executor.layers.quantization import QuantizationMethods
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/__init__.py", line 4, in <module>
    from vllm.model_executor.parameter import (BasevLLMParameter,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/parameter.py", line 10, in <module>
    from vllm.distributed import get_tensor_model_parallel_rank
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/__init__.py", line 4, in <module>
    from .communication_op import *
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/communication_op.py", line 9, in <module>
    from .parallel_state import get_tp_group
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/parallel_state.py", line 150, in <module>
    from vllm.platforms import current_platform
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/__init__.py", line 273, in __getattr__
    _current_platform = resolve_obj_by_qualname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/utils/__init__.py", line 2509, in resolve_obj_by_qualname
    module = importlib.import_module(module_name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/cuda.py", line 18, in <module>
    import vllm._C  # noqa
    ^^^^^^^^^^^^^^
ImportError: /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/_C.abi3.so: undefined symbol: _ZN3c104cuda9SetDeviceEab
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 567, in <module>
    main()
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 563, in main
    asyncio.run(main_async(args))
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 467, in main_async
    dset = load_input_dataset(args)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 275, in load_input_dataset
    dset_dict: DatasetDict = load_dataset(args.input_dataset)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1392, in load_dataset
    builder_instance = load_dataset_builder(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1132, in load_dataset_builder
    dataset_module = dataset_module_factory(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 1025, in dataset_module_factory
    raise e1 from None
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/datasets/load.py", line 980, in dataset_module_factory
    raise DatasetNotFoundError(f"Dataset '{path}' doesn't exist on the Hub or cannot be accessed.") from e
datasets.exceptions.DatasetNotFoundError: Dataset 'some_org/some_chat_dataset' doesn't exist on the Hub or cannot be accessed.
