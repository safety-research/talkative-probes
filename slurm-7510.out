[ensure_env] Using cached venv: /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Installing Python 3.12 via uv...
[ensure_env] Environment already exists at /home/kitf/.cache/uv/envs/consistency-lens
[ensure_env] Running on SLURM node: node-1
[ensure_env] Environment ready. Use 'uv run' (not uv_run) for all Python commands.
[ensure_env] Note: The uv_run function is available as a shortcut in this shell.
[ensure_env] Linked .venv -> /home/kitf/.cache/uv/envs/consistency-lens
Uninstalled 32 packages in 833ms
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/kitf/talkative-probes/talkative_autoencoder/scripts/generate_thinking_dataset.py", line 229, in <module>
    from transformers import AutoTokenizer
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/dependency_versions_check.py", line 16, in <module>
    from .utils.versions import require_version, require_version_core
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/utils/__init__.py", line 24, in <module>
    from .auto_docstring import (
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/utils/auto_docstring.py", line 30, in <module>
    from .generic import ModelOutput
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/utils/generic.py", line 55, in <module>
    from ..model_debugging_utils import model_addition_debugger_context
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/transformers/model_debugging_utils.py", line 29, in <module>
    import torch.distributed.tensor
ModuleNotFoundError: No module named 'torch.distributed'
Installed 49 packages in 22.97s
INFO 08-14 15:37:57 [__init__.py:241] Automatically detected platform cuda.
Traceback (most recent call last):
  File "/home/kitf/.cache/uv/envs/consistency-lens/bin/vllm", line 4, in <module>
    from vllm.entrypoints.cli.main import main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/__init__.py", line 3, in <module>
    from vllm.entrypoints.cli.benchmark.latency import BenchmarkLatencySubcommand
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/cli/benchmark/latency.py", line 5, in <module>
    from vllm.benchmarks.latency import add_cli_args, main
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/benchmarks/latency.py", line 16, in <module>
    from vllm import LLM, SamplingParams
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/__init__.py", line 64, in __getattr__
    module = import_module(module_name, __package__)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/entrypoints/llm.py", line 20, in <module>
    from vllm.config import (CompilationConfig, ModelDType, TokenizerMode,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/config.py", line 36, in <module>
    from vllm.model_executor.layers.quantization import QuantizationMethods
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/__init__.py", line 4, in <module>
    from vllm.model_executor.parameter import (BasevLLMParameter,
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/model_executor/parameter.py", line 10, in <module>
    from vllm.distributed import get_tensor_model_parallel_rank
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/__init__.py", line 4, in <module>
    from .communication_op import *
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/communication_op.py", line 9, in <module>
    from .parallel_state import get_tp_group
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/distributed/parallel_state.py", line 150, in <module>
    from vllm.platforms import current_platform
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/__init__.py", line 273, in __getattr__
    _current_platform = resolve_obj_by_qualname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/utils/__init__.py", line 2509, in resolve_obj_by_qualname
    module = importlib.import_module(module_name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/platforms/cuda.py", line 18, in <module>
    import vllm._C  # noqa
    ^^^^^^^^^^^^^^
ImportError: /home/kitf/.cache/uv/envs/consistency-lens/lib/python3.12/site-packages/vllm/_C.abi3.so: undefined symbol: _ZN3c104cuda9SetDeviceEab
